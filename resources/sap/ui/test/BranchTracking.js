/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
(function(){"use strict";var f=[],s=a(),S=[],t,r=/\w/;function b(i,B,n,q){if(B>=0){if(n){S[i].branchTracking[B].truthy+=1;}else{S[i].branchTracking[B].falsy+=1;}}if(q>=0){l(i,q);}return n;}function g(E,A,D){var V=parseInt(E.getAttribute(A));return V>0?V:D;}function a(){var s,q=document.getElementsByTagName("script"),i,n;for(i=0,n=q.length;i<n;i+=1){s=q[i];if(/BranchTracking.js$/.test(s.getAttribute("src"))){return s;}}}function c(i,n){var B=blanket.options("branchTracking"),q=false,D,x=f.length,y=i.inputFileName,z,A=i.inputFile,E;if(A.indexOf("// sap-ui-cover-browser msie")>=0){q=true;D=sap.ui.require("sap/ui/Device");if(D&&D.browser.msie){D=undefined;}}f.push(y);S[x]=_$blanket[y]=[];if(B){_$blanket[y].branchTracking=[];}_$blanket[y].source=A.split("\n");_$blanket[y].source.unshift("");_$blanket[y].warnings=[];E=""+falafel(A,{attachComment:q,comment:q,loc:true,range:true,source:A},v.bind(null,B,x,D));z=E.split("\n").length+1;if(z!==_$blanket[y].source.length){w(y,"Line length mismatch! "+_$blanket[y].source.length+" vs. "+z);}n(E);}function d(D,n){if(!("$ignored"in n)){if(n.parent&&d(D,n.parent)){n.$ignored=true;}else{n.$ignored=n.type==="BlockStatement"&&e(D,n);}}return n.$ignored;}function e(D,n){function i(q){return q.type==="Line"&&q.value===" sap-ui-cover-browser msie"&&!(D&&D.browser.msie);}return n.body[0]&&n.body[0].leadingComments&&n.body[0].leadingComments.some(i);}function l(i,n){S[i][n]+=1;}function v(B,i,D,n){var H=S[i],q=H.branchTracking,x=n.loc.start.line,y;function z(){n.update("blanket.$l("+i+", "+x+"); "+n.source());A();return true;}function A(){if(x in H){w(i,"Multiple statements on same line detected"+" â€“ minified code not supported! Line number "+x);}H[x]=0;}function E(){var J=n.loc.source.slice(n.left.range[1],n.right.range[0]);if(J[0]===")"){J=J.slice(1);}if(J.slice(-1)==="("){J=J.slice(0,-1);}return J;}if(D&&d(D,n)){return false;}switch(n.type){case"FunctionDeclaration":case"FunctionExpression":if(n.body.body[0]&&x===n.body.body[0].loc.start.line){w(i,"Function body must not start on same line! Line number "+x);}break;default:}switch(n.type){case"AssignmentExpression":case"ArrayExpression":case"BlockStatement":case"BinaryExpression":case"Block":case"CallExpression":case"CatchClause":case"DebuggerStatement":case"EmptyStatement":case"FunctionExpression":case"Identifier":case"Line":case"Literal":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"Program":case"Property":case"SequenceExpression":case"SwitchCase":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":case"VariableDeclarator":return false;case"ConditionalExpression":if(!B){return false;}n.test.update("blanket.$b("+i+", "+q.length+", "+n.test.source()+")");q.push({alternate:n.alternate.loc,consequent:n.consequent.loc,falsy:0,truthy:0});return true;case"ExpressionStatement":if(n.expression.type==="Literal"&&n.expression.value==="use strict"){return false;}case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":case"WithStatement":case"BreakStatement":case"ContinueStatement":case"FunctionDeclaration":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":return z(n);case"IfStatement":if(e(undefined,n.consequent)){B=false;}n.test.update("blanket.$b("+i+", "+(B?q.length:-1)+", "+n.test.source()+", "+x+")");A();if(B){q.push({alternate:(n.alternate||n.test).loc,consequent:n.consequent.loc,falsy:0,truthy:0});}return true;case"LogicalExpression":if(!B){return false;}if(n.operator==="||"||n.operator==="&&"){y="blanket.$b("+i+", "+q.length+", "+n.left.source()+") "+E()+" ("+n.right.source()+")";if(!r.test(n.loc.source[n.range[0]])){y=" "+y;}n.update(y);q.push({alternate:n.operator==="&&"?n.left.loc:n.right.loc,consequent:n.operator==="&&"?n.right.loc:n.left.loc,falsy:0,truthy:0});}return true;case"VariableDeclaration":if(n.parent.type==="ForInStatement"||n.parent.type==="ForStatement"){return false;}return z(n);case"LabeledStatement":default:throw new Error(n.source());}}function w(i,M){var n=typeof i==="string"?i:f[i];jQuery.sap.log.warning(M,n,"sap.ui.test.BranchTracking");_$blanket[n].warnings.push(M);}function h(){var M={},i=[],n;QUnit.begin(function(D){n=D.modules.length;D.modules.forEach(function(q){M[q.name]=q;});});QUnit.moduleStart(function(q){i=i.concat(Object.keys(M).filter(function(x){return M[x].tests===q.tests;}));});return function(){return i.length<n?i:undefined;};}if(window.blanket){window._$blanket={};blanket.$b=b;blanket.$l=l;blanket.instrument=c;var G=h(),L=g(s,"data-lines-of-context",3);t=Math.min(g(s,"data-threshold",0),100);sap.ui.require(["sap/ui/test/BlanketReporter"],function(B){blanket.options("reporter",B.bind(null,L,t,G));});}var I,C="sap.ui.base.SyncPromise",F={},m,N=0,T,u={},U=new Map();function j(n,q){var B,H=_$blanket[n.$currentFileName],x=F[n.$currentFileName],y;if(n.$oldHits){y=Object.keys(H).filter(function(i){return!(x&&x[i])&&H[i]===n.$oldHits[i];});q.notOk(y.length,"Some lines have not been covered by this module in isolation: "+y);}if(n.$oldBranchTracking){B=Object.keys(H.branchTracking).filter(function(i){return H.branchTracking[i].falsy===n.$oldBranchTracking[i].falsy||H.branchTracking[i].truthy===n.$oldBranchTracking[i].truthy;});q.notOk(B.length,"Some branches have not been fully covered by this module in isolation: "+B);}}function k(R){var i,n=Object.keys(u).length+U.size,M="Uncaught (in promise): "+n+" times\n",P,q,x,y;if(n){for(i in u){P=u[i];if(P.getResult()&&P.getResult().stack){M+=P.getResult().stack;}else{M+=P.getResult();}if(P.$error.stack){M+="\n>>> SyncPromise rejected with above reason...\n"+P.$error.stack.split("\n").slice(2).join("\n");}M+="\n\n";}u={};if(U.size){y=U.values();for(;;){x=y.next();if(x.done){break;}q=x.value;M+=(q&&q.stack||q)+"\n\n";}U.clear();}if(R){R(M);}else if(I){jQuery.sap.log.info("Clearing "+n+" uncaught promises",M,C);}}}if(s.getAttribute("data-uncaught-in-promise")!=="true"){window.addEventListener("unhandledrejection",function(E){if(E.reason.$uncaughtInPromise){return;}if(U){U.set(E.promise,E.reason);E.preventDefault();}else{alert("Uncaught (in promise) "+E.reason);}});window.addEventListener("rejectionhandled",function(E){if(U){U.delete(E.promise);}});}function o(P,i){if(i){delete u[P.$id];if(I){jQuery.sap.log.info("Promise "+P.$id+" caught",Object.keys(u),C);}return;}P.$id=N++;P.$error=new Error();u[P.$id]=P;if(I){jQuery.sap.log.info("Promise "+P.$id+" rejected with "+P.getResult(),Object.keys(u),C);}}function p(i,H){var A,n,B,q;H=H||{};A=H.after||function(){};n=H.afterEach||function(){};B=H.before||function(){};q=H.beforeEach||function(){};H.after=function(x){if(window.blanket&&!T&&!this.__ignoreIsolatedCoverage__&&t>=100){j(this,x);}return A.apply(this,arguments);};H.afterEach=function(x){var y=k.bind(null,x.ok.bind(x,false));function z(E){y();throw E;}function D(R){if(R&&typeof R.then==="function"){return R.then(D,z);}y();return R;}try{return D(n.apply(this,arguments));}catch(E){z(E);}};H.before=function(x){var y;this.$currentFileName=jQuery.sap.getResourceName(x.test.module.name);y=window.blanket&&_$blanket[this.$currentFileName];if(y){this.$oldHits=y.slice();if(y.branchTracking){this.$oldBranchTracking=JSON.parse(JSON.stringify(y.branchTracking,["falsy","truthy"]));}y.warnings.forEach(function(M){x.ok(false,M);});}return B.apply(this,arguments);};H.beforeEach=function(x){k();return q.apply(this,arguments);};m(i,H);}if(QUnit.module!==p){m=QUnit.module.bind(QUnit);QUnit.module=p;sap.ui.require(["sap/base/Log","sap/base/util/UriParameters","sap/ui/base/SyncPromise"],function(i,n,q){I=i.isLoggable(i.Level.INFO,C);T=new n(window.location.href).get("testId");q.listener=o;});QUnit.begin(function(){var i,H;jQuery("#qunit-modulefilter-dropdown-list").css("max-height","none");jQuery("#qunit-modulefilter-dropdown").click(function(M){if(M.target.tagName==="LABEL"){setTimeout(function(){jQuery("#qunit-modulefilter-actions").children().first().click();});}});if(window.blanket){for(i in _$blanket){H=_$blanket[i];F[i]=H.slice();}}});QUnit.done(function(){U=null;});}}());
